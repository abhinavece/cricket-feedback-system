# Production values for CricSmart Cricket Feedback System
# Override default values.yaml for production deployment
# Using MongoDB Atlas cloud cluster for database

# Production image tags (sync with values-development.yaml)
backend:
  image:
    tag: "2026.01.30.41"
  replicaCount: 2
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi
  # =============================================================
  # FEATURE FLAGS - Production Override
  # =============================================================
  # These are appended to the env vars from values.yaml
  # To DISABLE a feature quickly: change "true" to "false" below
  # Then redeploy with:
  #   helm upgrade cricket-feedback ./infra/helm/cricket-feedback \
  #     -n cricket-feedback \
  #     -f ./infra/helm/cricket-feedback/values.yaml \
  #     -f ./infra/helm/cricket-feedback/values-production.yaml
  # =============================================================
  extraEnv:
    # Feature Flags - All enabled for production
    - name: FF_MULTI_TENANT
      value: "true"
    - name: FF_TEAM_DISCOVERY
      value: "true"
    - name: FF_WHATSAPP_BYOT
      value: "false"
    # Uncomment to restrict to specific users during rollout:
    # - name: FF_TEAM_DISCOVERY_USERS
    #   value: "user1@email.com,user2@email.com"

frontend:
  image:
    registry: phx.ocir.io/axkw6whnjncs
    repository: cricket-feedback-frontend
    tag: "2026.01.31.48"
  replicaCount: 2
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

# AI Service production configuration
aiService:
  enabled: true
  image:
    tag: "2026.01.30.41"
  replicaCount: 1
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 200m
      memory: 256Mi
  env:
    - name: DAILY_REQUEST_LIMIT
      value: "1000"
    - name: AI_SERVICE_ENABLED
      value: "true"
    - name: AI_PROVIDER
      value: "google_ai_studio"
    - name: GOOGLE_AI_STUDIO_API_KEY
      valueFrom:
        secretKeyRef:
          name: ai-service-secrets
          key: google-ai-studio-api-key
    - name: MIN_CONFIDENCE_THRESHOLD
      value: "0.7"
    - name: LOG_LEVEL
      value: "INFO"
    - name: BACKEND_CALLBACK_URL
      value: "http://cricket-feedback-backend-service:5001"

# ============================================
# MongoDB Atlas Cloud Configuration
# ============================================
# DISABLED: In-cluster MongoDB is NOT used in production
# We use MongoDB Atlas cloud cluster for better stability & scalability
# Connection string is stored in cricket-secrets -> mongodb-uri
# ============================================
mongodb:
  enabled: false

# Production ingress with TLS
ingress:
  # Primary domain (new)
  host: app.cricsmart.in
  # Legacy domain (keep for backward compatibility during migration)
  secondaryHost: mavericks11.duckdns.org
  # Additional custom domains
  additionalHosts:
    - cricsmart.in
    - www.cricsmart.in
  tls:
    enabled: true
    secretName: cricket-feedback-tls

# Production autoscaling
autoscaling:
  enabled: true
  backend:
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
  frontend:
    minReplicas: 2
    maxReplicas: 5
    targetCPUUtilizationPercentage: 70

# Secrets are managed via kubectl - DO NOT commit real values
secrets:
  enabled: false
